# SSH Configuration - Generated by Ansible
# Security hardened SSH daemon configuration

# Basic Settings
Port {{ security.firewall.ssh_port | default(22) }}
Protocol 2
AddressFamily any
ListenAddress 0.0.0.0
ListenAddress ::

# Host Keys
HostKey /etc/ssh/ssh_host_rsa_key
HostKey /etc/ssh/ssh_host_ecdsa_key
HostKey /etc/ssh/ssh_host_ed25519_key

# Authentication
LoginGraceTime 2m
PermitRootLogin {{ 'yes' if security.ssh.permit_root_login | default(false) else 'no' }}
StrictModes yes
MaxAuthTries {{ security.ssh.max_auth_tries | default(3) }}
MaxSessions 10

# Authentication Methods
PubkeyAuthentication {{ 'yes' if security.ssh.pubkey_authentication | default(true) else 'no' }}
PasswordAuthentication {{ 'yes' if security.ssh.password_authentication | default(false) else 'no' }}
PermitEmptyPasswords no
ChallengeResponseAuthentication no
UsePAM yes

# Connection Settings
X11Forwarding no
X11DisplayOffset 10
PrintMotd no
PrintLastLog yes
TCPKeepAlive yes
ClientAliveInterval {{ security.ssh.client_alive_interval | default(300) }}
ClientAliveCountMax 2

# Logging
SyslogFacility AUTH
LogLevel INFO

# Security Settings
PermitUserEnvironment no
Compression delayed
AllowUsers ansible
AllowGroups sudo

# Banner
Banner /etc/ssh/banner

# Subsystem
Subsystem sftp /usr/lib/openssh/sftp-server

# Additional Security
UseDNS no
GSSAPIAuthentication no

