# Fail2ban configuration for AWS instances - Generated by Ansible

[DEFAULT]
# Ban hosts for one hour:
bantime = 3600

# Override /etc/fail2ban/jail.d/00-firewalld.conf:
banaction = iptables-multiport

[sshd]
enabled = true
port = 22
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 3600
findtime = 600

[apache]
enabled = {{ 'true' if service_type | default('') == 'web' else 'false' }}
port = http,https
filter = apache-auth
logpath = /var/log/apache*/*error.log
maxretry = 6

[nginx]
enabled = {{ 'true' if service_type | default('') == 'web' else 'false' }}
port = http,https
filter = nginx-http-auth
logpath = /var/log/nginx/error.log
maxretry = 6

[mysql]
enabled = {{ 'true' if service_type | default('') == 'database' else 'false' }}
port = 3306
filter = mysql-auth
logpath = /var/log/mysql/error.log
maxretry = 3
